<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <script src="https://code.jquery.com/jquery-3.5.1.js" charset="utf-8"></script>
    <title>Omroep Zeeland getter (b)</title>
	<style>img{display: inline-block;}</style>
  </head>
  <body>
	Link: <input type=text id=pub placeholder="https://www.omroepzeeland.nl/tv/programma/370060062/De-Canon-van-Zeeland/aflevering/370077612/Nehalennia-en-haar-tempel" value="https://www.omroepzeeland.nl/tv/programma/370060062/De-Canon-van-Zeeland/aflevering/370077612/Nehalennia-en-haar-tempel"><button onclick="getThem();">Get Media</button><br>
	<div id=o></div>
    <script>
	function getThem(){
		let pub=document.getElementById("pub").value;
		let o = document.getElementById("o");
		$.get(pub, data=>{
		//https://omroepzeeland.bbvms.com/p/regiogrid
			id=data.split("omroepzeeland.bbvms.com/p/regiogrid")[1].split(".html")[0];
			$.get("https://omroepzeeland.bbvms.com/p/regiogrid"+id+".js", dat=>{
				dat = JSON.parse(dat.split("var opts = ")[1].split(";\n\n\t// include bluebillywig script")[0]);
				for(i=0; i<dat.clipData.assets.length; i++){
					let tmp=document.createElement("video");
					tmp.controls="on";
					let srt=document.createElement("source");
					srt.src=dat.publicationData.defaultMediaAssetPath+dat.clipData.assets[i].src;
					let tmpp=document.createElement("p");
					tmpp.innerHTML=dat.clipData.assets[i].jobqid||dat.clipData.assets[i].jobqid||(dat.clipData.assets[i].mediatype.toLowerCase()+"-"+dat.clipData.assets[i].width+"x"+dat.clipData.assets[i].height+"-"+dat.clipData.assets[i].bandwidth)+":";
					o.appendChild(tmpp);
					tmp.appendChild(srt);
					o.appendChild(tmp);
					console.log(srt.src);
				}
			});
		});
	}
    </script>
  </body>
</html>

